<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JoinVenture</title>
    <!-- logo -->
    <link rel="shortcut icon" type="image/png" href="../../logo.png" />
  
    <!-- jquery CDN include -->
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="confirm.css">
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- bootwatch -->
    <link rel="stylesheet" href="bootwatch.css">

    <!-- CSS -->
    <link rel="stylesheet" href="profile.css">

    <!-- fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>

    <!-- SIgnalR -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/5.0.11/signalr.min.js"></script>

</head>


<body>

<!-- Nav -->
<div id="navbarContainer"></div>
<!-- Nav -->

  <div class="container">
    <div class="main-body">
        
          <div class="row gutters-sm">

                    <!-- User資料 col-4-->
                    <div class="col-md-4 mb-3">
                            <!-- 大頭 -->
                            <div class="card">
                                <div class="card-body">
                                <div class="d-flex flex-column align-items-center text-center">
                                    <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle userImage" width="150" height="150" style = "object-fit: cover;object-position: center;">
                                    <div class="mt-3">
                                    <h4 class = "showName">John Doe</h4>
                                    <!-- <p class="text-secondary mb-1">Full Stack Developer</p>
                                    <p class="text-muted font-size-sm">Bay Area, San Francisco, CA</p> -->

                                    </div>
                                </div>
                                </div>
                            </div>
                             <!-- 大頭 -->

                            <!-- 個資卡 -->
                            <div class="card mt-3 UserProfile">
                                <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                    <h6 class="mb-0"><img width="24" height="24" src="https://img.icons8.com/plumpy/24/person-male--v1.png" alt="person-male--v1"/>暱稱</h6>
                                    <span class="text-secondary showName">https://bootdey.com</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                    <h6 class="mb-0"><img width="24" height="24" src="https://img.icons8.com/material-sharp/24/person-male.png" alt="person-male"/>姓名</h6>
                                    <span class="text-secondary userName">bootdey</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                    <h6 class="mb-0"><img width="24" height="24" src="https://img.icons8.com/material/24/phone--v1.png" alt="phone--v1"/>電話</h6>
                                    <span class="text-secondary phoneNumber">@bootdey</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                    <h6 class="mb-0"><img width="24" height="24" src="https://img.icons8.com/material-outlined/24/iphone--v2.png" alt="iphone--v2"/>手機</h6>
                                    <span class="text-secondary mobile">bootdey</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                    <h6 class="mb-0"><img width="24" height="24" src="https://img.icons8.com/material/24/address--v2.png" alt="address--v2"/>地址</h6>
                                    <span class="text-secondary address">bootdey</span>
                                </li>
                                </ul>
                                <div class="row p-2 text-center">
                                    <div class="col-sm-12">
                                        <button class="btn btn-primary" target="__blank" type ="button">Edit</a>
                                    </div>
                                </div>
                            </div>
                            <!-- 個資卡 -->
                    </div>
                     <!-- User資料 col-4-->

            

                     <!-- Order資料 col-8-->
                    <div class="col-md-8 OrderSection">


                        <!-- User Orders -->
                            <!-- <div class="card mb-3">
                                <div class="card-body"> -->


                                    <!-- Activity Title -->
                                    <!-- <div class="row">
                                        <div class="col-sm-3">
                                        <h6 class="mb-0 activityName">Activity Name</h6>
                                        </div>
                                    </div>
                                    <hr> -->
                                    
                                    <!-- Activity Title -->

                                    <!-- TicketPackage -->

                                    <!-- <div class="ticket m-3"> -->
                                            <!-- 左半部 -->
                                            <!-- <div class="left"> -->
                                                <!-- 左圖 -->
                                                <!-- <div class="image activityImage"> -->
                                                <!-- </div> -->
                                                <!-- 左圖 -->
                                                <!-- 中間資訊 -->
                                                <!-- <div class="ticket-info">
                                                    <p class="date ">
                                                        <span class="validDate">2023-09-03 03:20 - 2023-09-03 05:20</span>
                                                    </p>
                                                    <div class=".ticket-infot">
                                                        <h3 class="ticketTitle">SOUR Prom</h3>
                                                        <h5 class="ticketQuantity">x 張</h5>
                                                    </div>

                                                    <p class="location"><span>祝您愉快</span><i class="far fa-smile"></i></p>
                                                </div> -->
                                                <!-- 中間資訊 -->

                                            <!-- </div> -->

                                            <!-- 右半部 -->
                                            <!-- <div class="right">
                    
                                                <div class="right-info-container">
                                                    <div class="barcode">
                                                        <img src="https://external-preview.redd.it/cg8k976AV52mDvDb5jDVJABPrSZ3tpi1aXhPjgcDTbw.png?auto=webp&s=1c205ba303c1fa0370b813ea83b9e1bddb7215eb" alt="QR code">
                                                    </div>
                                                    <p class="ticket-number OrderId">
                                                        #20030220
                                                    </p>
                                                </div>
                                            </div>
                                    </div> -->

                                     <!-- TicketPackage -->


                                <!-- </div>
                            </div> -->
                        <!-- User Orders -->
                    </div>
                     <!-- Order資料 col-8-->

          </div>
        </div>
    </div>



</body>
  <script>
      // Use jQuery to load the content of navbar.html into the #navbarContainer div
      $(document).ready(function () {
          $('#navbarContainer').load('navbar.html');
      });
  </script>
<script>
    var GetUserUrl = 'http://localhost:5000/api/Account';
    var jwtToken = localStorage.getItem("token");

    $(document).ready(function () {
            $.get({
            url: GetUserUrl,
            dataType: "json",
            contentType: "application/json",
            beforeSend: function(xhr) {
                // Set the Authorization header with the JWT token
                xhr.setRequestHeader("Authorization", "Bearer " + jwtToken);
            },
            success: (res) => {

                // UserProfile Part
                $(".showName").text(res.showName);
                $(".userName").text(res.userName);
                $(".phoneNumber").text(res.phoneNumber);
                $(".mobile").text(res.mobile);
                $(".address").text(res.address);
                $(".userImage").attr("src",res.photos[0].url)

                // User Orders Part
                const OrderSection = $(".OrderSection");
                       res.orders.forEach((order) => {
                        const orderCard = `
                            <div class="card mb-3">
                                <div class="card-body">
                                    <!-- Activity Title -->
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0 activityName">${order.activityTitle}</h6>
                                        </div>
                                    </div>
                                    <hr>

                                    <!-- TicketPackage -->
                                    ${order.bookedTicketPackages.map((package) => `
                                        <div class="ticket m-3">
                                            <div class="left">
                                                <div class="image activityImage" style="background-image: url(${order.activityImage});background-size: cover; background-position: center;">
                                                </div>
                                                <div class="ticket-info">
                                                    <p class="date">
                                                        <span class="validDate">${package.validDate}</span>
                                                    </p>
                                                    <div class=".ticket-infot">
                                                        <h3 class="ticketTitle">${package.title}</h3>
                                                        <h5 class="ticketQuantity">${package.quantity} 張</h5>
                                                    </div>
                                                    <p class="location"><span>祝您愉快</span><i class="far fa-smile"></i></p>
                                                </div>
                                            </div>
                                            <div class="right">
                                                <div class="right-info-container">
                                                    <div class="barcode">
                                                        <img src="https://external-preview.redd.it/cg8k976AV52mDvDb5jDVJABPrSZ3tpi1aXhPjgcDTbw.png?auto=webp&s=1c205ba303c1fa0370b813ea83b9e1bddb7215eb" alt="QR code">
                                                    </div>
                                                    <p class="ticket-number OrderId">#${order.id.substring(0, 8)}</p>
                                                </div>
                                            </div>
                                        </div>
                                    `).join('')}
                                    <!-- TicketPackage -->
                                </div>
                            </div>
                        `;

                        // Insert the order card after the UserProfile card
                        OrderSection.append(orderCard);
                 });


            },
            error: (err) =>{
                console.log(err);
            }

        })
    })

</script>
</html>